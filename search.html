<!doctype html>
<html lang="es">

<body>

<!-- dropdown -->
    <div class="col-md-12 col-sm-6">
        <div class="btn-group btn-block">
            <button class="btn btn-default btn-block dropdown-toggle" type="button" data-toggle="dropdown">
                  <span>buscar por</span>
                <span class="pull-right"><span class="caret"></span></span>
            </button>

            <ul class="dropdown-menu btn-block" id="code_selection">
                <li><button class="btn_menu btn-block" value="">todos</button></li>
                <li><button class="btn_menu btn-block" value="na">nombre</button></li>
                <li><button class="btn_menu btn-block" value="co">código</button></li>
                <li><button class="btn_menu btn-block" value="ip">ip</button></li>
                <li><button class="btn_menu btn-block" value="ad">dirección</button></li>
                <li><button class="btn_menu btn-block" value="te">teléfono</button></li>
            </ul>
        </div>
    </div>

    <!--input de búsqueda-->
    <div class="col-md-12 col-sm-6">
        <form>
            <div class="input-group">
                <input type="text" class="form-control" title="Busqueda" placeholder="ingrese búsqueda" id="inp_search_box">
                <span class="input-group-btn"><button class="btn btn-default" type="button" id="btn_search_box"> <span class="glyphicon glyphicon-search"></span></button></span>
            </div>
        </form>
    </div>

    <br/>

    <!-- Los resultados se muestran acá -->
<div class="row top-buffer">
    <br/>
    <br/>
    <div id="results">

    </div>
</div>

<script>

    $("#inp_search_box").focus();

    $("#btn_search_box").on('click',function(){sendQuery();});

    function sendQuery(){
        if($("#inp_search_box").val() == ""){

            $("#results").html("<p class='text-center bg-danger'>no se ingresaron datos</p>");

            $("#results").fadeOut(0).delay(100).fadeIn(100);
        }else{

            $("#results").html("");
            //enviar query
            $.get("search.php", {query:$("#inp_search_box").val()},function(external){
                $("#results").html(external);
            });
        }
    }
        $(".btn_menu").click(function(){

            var codeSelected = $(this).attr("value");

            if($("#inp_search_box") == ""){
                if(codeSelected== ""){

                }else{
                    $("#inp_search_box").val(":" + codeSelected + " ");
                }
            }else{
                if( $("#inp_search_box").val().charAt(0)==':'){
                    //borra caracteres hasta el primer espacio
                    $("#inp_search_box").val($("#inp_search_box").val().substring($("#inp_search_box").val().indexOf(' ')).trim());
                    $("#inp_search_box").val(":" + codeSelected + " " + $("#inp_search_box").val());
                }else{
                    $("#inp_search_box").val(":" + codeSelected + " " + $("#inp_search_box").val());
                }
            }

            $("#inp_search_box").focus();

        });


    $(document).keypress(function(event){
        if(event.which == 13){
            $("#inp_search_box").focus();
            console.log("espere un momento...");
            $("#btn_search_box").trigger('click');
        }
    });


</script>
</body>