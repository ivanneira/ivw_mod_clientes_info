<!doctype html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Busqueda y edición</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">


</head>

<body>
<div class="container-full">


    <div class="row">

        <div class="col-lg-12 text-center v-center">



            <form class="col-lg-12">
                <div class="form-group input-group col-sm-offset-4  col-sm-4">
                    <label for="code_selection">Buscar por:</label>
                    <select class="form-control" id="code_selection">
                        <option value="" class="code">todos</option>
                        <option value="na" class="code">nombre</option>
                        <option value="co" class="code">código</option>
                        <option value="ip" class="code">ip</option>
                        <option value="ad" class="code">dirección</option>
                        <option value="te" class="code">teléfono</option>
                    </select>
                </div>
                <div class="input-group input-group-lg col-sm-offset-4 col-sm-4">
                    <input type="text" class="center-block form-control input-lg" title="Busqueda" placeholder="ingrese búsqueda" id="inp_search_box">
                    <span class="input-group-btn"><button class="btn btn-lg btn-default" type="button" id="btn_search_box">></button></span>
                </div>
            </form>
        </div>

    </div>

    <br/>


    <div class="container" id="results">

    </div>

</div>

<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/bootstrap.min.js"></script>

<script>
    $("#inp_search_box").focus();

    /*
    $("#code_selection").click(function(){
         if($(this).val()=='') {
             $("#inp_search_box").val('');
         }else $("#inp_search_box").val(":" + $("#code_selection").val() + " ");
    });
    */

    $("#code_selection").on('change',function(){

        if($(this).val()=='') {
            $("#inp_search_box").val('');
        }else if($("#inp_search_box").val()==''){
            $("#inp_search_box").val(":" + $("#code_selection").val() + " ");
        }else {
            $("#inp_search_box").val(":" + $("#code_selection").val() + " " + $("#inp_search_box").val());
        }
        $("#inp_search_box").focus();
    });
    //TODO: buscar al presionar Enter

    function sendQuery(){

        var searchString = $("#inp_search_box").val();

        if(searchString!=''){


            $.get("search.php", {query:searchString},function(external){
                $("#results").html(external);
            });
        }else{

            $("#results").html("<p class='text-center bg-danger'>no se ingresaron datos</p>");

            $("#results").fadeOut(0).delay(100).fadeIn(100);
        }
    }

    $("#btn_search_box").click(function(){sendQuery()});

</script>
</body>